<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.tweiy.mapper.DataStatisticsMapper">
    <!-- 班级人数统计 -->
    <select id="countClassStudent" resultType="java.util.Map">
        select c.name      as class_name,
               count(s.id) as student_count
        from clazz c
                 left join student s on c.id = s.clazz_id
        group by c.id, c.name
        order by student_count
    </select>

    <!--    学员学历统计-->
    <select id="countStudentEducation" resultType="java.util.Map">
        select (case t.degree
                    when 1 then '初中'
                    when 2 then '高中'
                    when 3 then '大专'
                    when 4 then '本科'
                    when 5 then '硕士'
                    when 6 then '博士'
                    else '其他'
            end) as education,
               t.student_count
        from (
                 select degree,
                        count(*) as student_count
                 from student
                 group by degree
             ) t
        order by t.student_count
    </select>
</mapper>
